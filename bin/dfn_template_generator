#!/usr/bin/env python3
import os
import argparse
import yaml
from cdff_dev.code_generator import write_dfn
from cdff_dev.path import check_cdffpath


def main():
    args = parse_args()
    check_cdffpath(args.cdffpath)
    with open(args.definition, "r") as f:
        node = yaml.load(f)
    write_dfn(node, args.output, args.cdffpath)


def parse_args():
    argparser = argparse.ArgumentParser(description="DFN template generator")
    argparser.add_argument(
        "definition", type=str, help="Node definition")
    argparser.add_argument(
        "output", type=str, help="Target directory", nargs="?", default=".")
    argparser.add_argument(
        "--cdffpath", type=str, help="Path to CDFF repository.", nargs="?",
        default=".")
    return argparser.parse_args()


if __name__ == "__main__":
    main()
